{% extends "base.html" %}
{% load static %}

{% block title %}Machines{% endblock %}

{% block css %}
<link rel="stylesheet" href="{% static 'css/machines.css' %}">
{% endblock %}

{% block content %}

<!-- ヘッダー -->
<header class="machines-header">
  <a href="/" class="icon-btn">←</a>
  <h1 class="store-name">{{ store.name }}</h1>
  <a href="/menu/" class="icon-btn">☰</a>
</header>

<!-- 店舗タブ（A） -->
<div class="store-tabs">
  <a href="/machines/?store=gotanda"
     class="store-tab {% if store_key == 'gotanda' %}active{% endif %}">
    五反田
  </a>
  <a href="/machines/?store=meguro"
     class="store-tab {% if store_key == 'meguro' %}active{% endif %}">
    目黒
  </a>
  <a href="/machines/?store=osaki"
     class="store-tab {% if store_key == 'osaki' %}active{% endif %}">
    大崎
  </a>
</div>

<!-- 台数サマリ（B） -->
<p class="machine-summary">
  空き <strong>{{ available_count }}</strong> 台 /
  使用中 <strong>{{ busy_count }}</strong> 台
</p>

<!-- スクロール -->
<div class="scroll-area">

  <p class="hint">
    タップで「空き / 使用中」を切り替えられます（簡易）
  </p>

  <section class="machine-list">
    {% for machine in machines %}
      <a href="{% url 'toggle_machine_status' machine.id %}?store={{ store_key }}"
         class="machine-card {{ machine.status }}">

        <div class="machine-info">
          <p class="machine-name">{{ machine.name }}</p>
          <span class="difficulty {{ machine.difficulty }}">
            {{ machine.difficulty|upper }}
          </span>
        </div>

        <span class="status">
          {% if machine.status == "available" %}空き{% else %}使用中{% endif %}
        </span>

      </a>
    {% empty %}
      <div class="empty">マシンがありません</div>
    {% endfor %}
  </section>

</div>

{% endblock %}